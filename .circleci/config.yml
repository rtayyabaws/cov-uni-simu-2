version: 2.1

jobs:
  tf_plan_only:
    docker:
      - image: cimg/base:stable
    steps:
      - checkout
      - run:
          name: Install Terraform
          command: |
            sudo apt-get update -y
            sudo apt-get install -y unzip curl python3-pip
            curl -o tf.zip -L https://releases.hashicorp.com/terraform/1.6.6/terraform_1.6.6_linux_amd64.zip
            sudo unzip -o tf.zip -d /usr/local/bin
            terraform -version
      - run: terraform init -input=false
      - run: terraform validate
      - run: terraform plan -input=false

workflows:
  tf:
    jobs:
      - tf_plan_only
